# coding=utf-8
import cv2 as cv
from  PIL import Image
import pytesseract as tess

def open_demo(image):
    # 灰度图操作
    #image = cv.resize(img, (300, 200), interpolation=cv.INTER_AREA)
    gray = cv.cvtColor(image,cv.COLOR_BGR2GRAY)
    cv.imshow("huidu",gray)
    # 二值化操作
    ret,binary = cv.threshold(gray,0,255,cv.THRESH_BINARY_INV | cv.THRESH_OTSU)  #cv.THRESH_TRIANGLE
    cv.imshow("binary",binary)
    # 矩形元素
    kernel = cv.getStructuringElement(cv.MORPH_RECT, (2,2)) #  未赋值，所以只是一个操作。
    # 形态学操作
    bin1 = cv.morphologyEx(binary, cv.MORPH_OPEN, kernel) # 开操作
    cv.imshow("1",bin1)
    #kernel = cv.getStructuringElement(cv.MORPH_RECT, (1, 5))
    # 形态学操作
    #open_out = cv.morphologyEx(bin1, cv.MORPH_OPEN, kernel)
    #cv.imshow("xingtai", open_out)
    cv.bitwise_not(bin1,bin1)
    textimage = Image.fromarray(bin1)
    print(textimage)
    text = tess.image_to_string(textimage)
    print(text)

src = cv.imread("E:/opencv_pictures/yanzhengma/yanzhengma.jpg")
#cv.namedWindow("test", cv.WINDOW_AUTOSIZE)
#cv.imshow("test", src)
open_demo(src)
cv.waitKey(0)
cv.destroyAllWindows()

"""
http://blog.csdn.net/u011028345/article/details/77278467
bitwise_and是对二进制数据进行“与”操作，即对图像（灰度图像或彩色图像均可）每个像素值进行二进制“与”操作，1&1=1，1&0=0，0&1=0，0&0=0
bitwise_or是对二进制数据进行“或”操作，即对图像（灰度图像或彩色图像均可）每个像素值进行二进制“或”操作，1|1=1，1|0=0，0|1=0，0|0=0
bitwise_xor是对二进制数据进行“异或”操作，即对图像（灰度图像或彩色图像均可）每个像素值进行二进制“异或”操作，1^1=0,1^0=1,0^1=1,0^0=0
bitwise_not是对二进制数据进行“非”操作，即对图像（灰度图像或彩色图像均可）每个像素值进行二进制“非”操作，~1=0，~0=1
"""






















































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































